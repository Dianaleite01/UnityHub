@model IEnumerable<UnityHub.Models.Candidaturas>

@{
    ViewData["Title"] = "Candidaturas";
}

<h1>Candidaturas</h1>

<p>
    <a asp-action="Create">Create New</a>
</p>
<table class="table" id="candidaturasTable">
    <thead>
        <tr>
            <th>
                Estado
            </th>
            <th>
                Vaga
            </th>
            <th>
                Utilizador
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

@section Scripts {
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '@Url.Action("GetCandidaturas", "Candidaturas")',
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    var tbody = $('#candidaturasTable tbody');
                    tbody.empty();
                    $.each(data, function (index, item) {
                        var row = $('<tr>');
                        row.append($('<td>').text(item.Estado));
                        row.append($('<td>').text(item.Vaga.Descricao));
                        row.append($('<td>').text(item.Utilizador.Nome));
                        row.append($('<td>').html('<a href="/Candidaturas/Edit/' + item.Id + '">Edit</a> | <a href="/Candidaturas/Details/' + item.Id + '">Details</a> | <a href="/Candidaturas/Delete/' + item.Id + '" onclick="return confirm(\'Are you sure you want to delete this item?\');">Delete</a>'));
                        tbody.append(row);
                    });
                },
                error: function () {
                    alert('Failed to retrieve data.');
                }
            });
        });
    </script>
}
